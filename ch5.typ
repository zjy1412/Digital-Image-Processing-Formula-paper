#import "@preview/mitex:0.2.4": *
#heading[Chapter 5]

== å›¾åƒé€€åŒ–/å¤åŸæ¨¡å‹

// #image("./img/txfy.png",height: 10%)

ç©ºåŸŸï¼š$g(x, y) =(h star f)(x, y) + eta(x, y)$

é¢‘åŸŸï¼š$G(u, v) = H(u, v) F(u, v) +N(u, v)$

== å™ªå£°æ¨¡å‹

// é«˜æ–¯,ç‘åˆ©,ä¼½é©¬,æŒ‡æ•°,å‡åŒ€,æ¤’ç›

é«˜æ–¯ $p(z) = frac(1, sqrt(2 pi) sigma) e^(-(z - macron(z))^2 \/ 2 sigma^2)$

ç‘åˆ© $p(z) =mat(delim: #none, frac(2, b)(z - a) e^(-(z - a)^2 - b), comma z gt.eq a;
0, comma z < a,)$ || $macron(z) = a + sqrt(pi b \/ 4), sigma^2 = frac(b(4 - pi), 4)$

ä¼½é©¬ $p(z) = frac(1, gamma) z^{gamma - 1} e^(-z - gamma) $

æŒ‡æ•° $p(z) = mat(delim: #none, frac(a^b z^(b - 1),(b - 1)!) e^(-a z), comma z gt.eq 0;
0, comma z < 0,)$ || $macron(z) = frac(1, a), sigma^2 = frac(1, a^2)$

å‡åŒ€ $p(z) =
mat(delim: #none, frac(1, b - a), comma a lt.eq z lt.eq b;
0, comma o t h e r w i s e,)$ || $macron(z) = frac(a + b, 2), sigma^2 = frac((b - a)^2, 12)$

æ¤’ç› $p(z) =
mat(delim: #none, P_s, comma z = 2^(k - 1);
P_p, comma z = 0;
1 -(P_s + P_p), comma z = V,)$

å‚æ•°ä¼°è®¡ $mu = sum_(z_i in S) z_i p(z_i) quad sigma^2 = sum_(z_i in S)(z_i - mu)^2 p(z_i)$

== åªå­˜åœ¨å™ªå£°çš„å¤åŸâ€”â€”ç©ºé—´æ»¤æ³¢

åŠ æ€§å™ªå£°é€€åŒ–å: $g(x, y) = f(x, y) + eta(x, y)$ $G(u, v) = F(u, v) +N(u, v)$ (å™ªå£°æœªçŸ¥)

==== å‡å€¼æ»¤æ³¢
ç®—æœ¯å¹³å‡æ»¤æ³¢ $hat(f)(x, y) = frac(1, m n) sum_((r, c) in S_(x y)) g(r, c)$

Sè¡¨ç¤ºä¸­å¿ƒåœ¨(x,y)ï¼Œå°ºå¯¸ä¸ºğ‘šxnçš„å›¾åƒ;å¹³æ»‘äº†ä¸€å¹…å›¾åƒçš„å±€éƒ¨å˜åŒ–;åœ¨æ¨¡ç³Šäº†ç»“æœçš„åŒæ—¶å‡å°‘äº†å™ªå£°

å‡ ä½•å¹³å‡æ»¤æ³¢ $hat(f)(x, y) = [ product_((r, c) in S_(x y)) g(r, c) ]^frac(1, m n)$

å¹³æ»‘åº¦å¯ä»¥ä¸ç®—æœ¯å‡å€¼æ»¤æ³¢å™¨ç›¸æ¯”;å›¾åƒç»†èŠ‚ä¸¢å¤±æ›´å°‘

è°æ³¢å¹³å‡æ»¤æ³¢ $hat(f)(x, y) = frac(m n, sum_((r comma c) in S_(x y)) frac(1, g(r comma c)))$ å¯¹äºâ€œç›ç²’â€æ•ˆæœå¥½ï¼Œä¸é€‚ç”¨äºâ€œèƒ¡æ¤’â€; å–„äºå¤„ç†åƒé«˜æ–¯å™ªå£°çš„å™ªå£°

åè°æ³¢å¹³å‡ $hat(f)(x, y) = (sum_((r, c) in S_(x y)) g(r, c)^(Q + 1))/( sum_((r, c) in S_(x y)) g(r, c)^Q)$ Qç§°ä¸ºæ»¤æ³¢å™¨çš„é˜¶æ•°,`>0`ç”¨äºèƒ¡æ¤’, `<0`ç”¨äºç›ç²’,=0å˜ä¸ºç®—æ•°å¹³å‡,=-1å˜ä¸ºè°æ³¢å¹³å‡


==== ç»Ÿè®¡æ’åº

ä¸­å€¼ $hat(f)(x, y) = m e d i a n((r, c) in S_(x y)) {g(r, c)}$ ä¸å¤§å°ç›¸åŒçš„çº¿æ€§å¹³æ»‘æ»¤æ³¢ï¼ˆå‡å€¼æ»¤æ³¢ï¼‰ç›¸æ¯”ï¼Œæœ‰æ•ˆåœ°é™ä½æŸäº›éšæœºå™ªå£°ï¼Œä¸”æ¨¡ç³Šåº¦è¦å°å¾—å¤š


æœ€å¤§å€¼ $hat(f)(x, y) = max_((r, c) in S_(x y)) mat(delim: #none, g(r comma c))$ å‘ç°æœ€äº®ç‚¹,è¿‡æ»¤èƒ¡æ¤’

æœ€å°å€¼ $hat(f)(x, y) = min_((r, c) in S_(x y)) mat(delim: #none, g(r comma c))$ å‘ç°æœ€æš—ç‚¹,è¿‡æ»¤ç›ç²’

ä¸­ç‚¹$hat(f)(x, y) = frac(1, 2)  [ max_((r, c) in S_(x y))  {g(r, c) } + min_((r, c) in S_(x y))  {g(r, c) }  ]$é€‚åˆå¤„ç†éšæœºåˆ†å¸ƒçš„å™ªå£°ï¼Œå¦‚é«˜æ–¯å™ªå£°å’Œå‡åŒ€å™ªå£°

ä¿®æ­£åçš„é˜¿å°”æ³•å‡å€¼æ»¤æ³¢ $hat(f)(x, y) = frac(1, m n - d) sum_((r, c) in S_(x y)) g_R (r, c)$

åœ¨ğ‘†é‚»åŸŸå†…å»æ‰ğ‘”(r, c)æœ€é«˜ç°åº¦å€¼çš„ğ‘‘/2å’Œæœ€ä½ç°åº¦å€¼çš„d/2ã€‚ ä»£è¡¨å‰©ä½™çš„ğ‘šğ‘› - ğ‘‘ä¸ªåƒç´  d=0å˜ä¸ºç®—æ•°å¹³å‡.=mn-1å˜ä¸ºä¸­å€¼

==== è‡ªé€‚åº”

$g(x,y)$è¡¨ç¤ºå™ªå£°å›¾åƒåœ¨ç‚¹$(x,y)$ä¸Šçš„å€¼

$sigma_eta^2$å™ªå£°æ–¹å·®

$overline(z)_(S_(x y))$ åœ¨$S_upright(x y)$ä¸Šåƒç´ ç‚¹çš„å±€éƒ¨å¹³å‡ç°åº¦

$sigma_(S_(x y))^2$ åœ¨$S_upright(x y)$ä¸Šåƒç´ ç‚¹çš„å±€éƒ¨æ–¹å·®

====== å±€éƒ¨é™å™ª

$hat(f)(x, y) = g(x, y) - frac(sigma_eta^2, sigma_(S_(x y))^2) [ g(x, y) - overline(z)_(S_(x y)) ]$

====== è‡ªé€‚åº”ä¸­å€¼

$z_(m i n)$æ˜¯$S_{x y}$ä¸­çš„æœ€å°ç°åº¦å€¼;$z_(m a x)$æ˜¯$S_{x y}$ä¸­çš„æœ€å¤§ç°åº¦å€¼;$z_(m e d)$æ˜¯$S_{x y}$ä¸­çš„ç°åº¦å€¼çš„ä¸­å€¼;$z_{x y}$æ˜¯åæ ‡$(x,y)$å¤„çš„ç°åº¦å€¼;$S_(m a x)$æ˜¯$S_{x y}$å…è®¸çš„æœ€å¤§å°ºå¯¸ã€‚

å±‚æ¬¡ A: è‹¥$z_(m i n)<z_(m e d)<z_(m a x)$,åˆ™è½¬åˆ°å±‚æ¬¡$B$

å¦åˆ™ï¼Œå¢$S_{x y}$çš„å°ºå¯¸ï¼Œ

è‹¥$S_{x y}\leq S_(m a x)$,åˆ™é‡å¤å±‚æ¬¡ A

å¦åˆ™ï¼Œè¾“å‡º$z_(m e d)$

å±‚æ¬¡ B: è‹¥$z_(m i n)<z_{x y}<z_(m a x)$,åˆ™è¾“å‡º $z_{x y}$

å¦åˆ™ï¼Œè¾“å‡º$z_(m e d)$

== é™·æ³¢æ»¤æ³¢å™¨

$H_upright(N R) (u, nu) = product_(k = 1)^Q H_k (u, nu) H_(-k)(u, nu)$


é™·æ³¢å¸¦é€šæ»¤æ³¢å™¨ $H_upright(N P) (u, nu) = 1 - H_upright(N R) (u, nu)$

æœ€ä¼˜é™·æ³¢

$N(u, nu) = H_upright(N P) (u, nu) G(u comma nu)$   $eta(x, y) = frak(T)^(-1) {H_upright(N P) (u, nu) G(u, nu)}$  $hat(f)(x, y) = g(x, y) - w(x, y) eta(x, y)$

$w (x , y) = frac(overline(g eta) - overline(g) overline(eta), overline(eta^2) - overline(eta)^2)$

== çº¿æ€§ä½ç½®ä¸å˜é€€åŒ–

å¦‚æœé€€åŒ–æ¨¡å‹ä¸ºçº¿æ€§å’Œä½ç½®ä¸å˜çš„

$ g(x, y) =(h star f)(x, y) + eta(x, y) \ G(u, v) = H(u, v) F(u, v) + N(u, v) $

== ä¼°è®¡é€€åŒ–å‡½æ•°
è§‚å¯Ÿæ³• æ”¶é›†å›¾åƒè‡ªèº«çš„ä¿¡æ¯

è¯•éªŒæ³• ä½¿ç”¨ä¸è·å–é€€åŒ–å›¾åƒçš„è®¾å¤‡ç›¸ä¼¼çš„è£…ç½®

æ•°å­¦å»ºæ¨¡æ³• å»ºç«‹é€€åŒ–æ¨¡å‹ï¼Œæ¨¡å‹è¦æŠŠå¼•èµ·é€€åŒ–çš„ç¯å¢ƒå› ç´ è€ƒè™‘åœ¨å†…
== é€†æ»¤æ³¢

$hat(F)(u, v) = frac(G(u comma v), H(u comma v))=F(u, v) + frac(N(u comma v), H(u comma v))$

== æœ€å°å‡æ–¹è¯¯å·®ï¼ˆç»´çº³ï¼‰æ»¤æ³¢

$hat(F)(u, v) = [ frac(1, H(u comma v)) frac(lr(|H(u comma v)|)^2, lr(|H(u comma v)|)^2 + S_eta (u comma v) \/ S_f (u comma v)) ] G(u, v)$

$hat(F)(u, v) = [ frac(1, H(u comma v)) frac(lr(|H(u comma v)|)^2, lr(|H(u comma v)|)^2 + K) ] G(u, v)$ ï¼ˆå‡è®¾ä¸¤ä¸ªåŠŸç‡è°±ä¹‹æ¯”ä¸ºå¸¸æ•°Kï¼‰

// $H(u,v)$ä¸ºé€€åŒ–ä¼ é€’å‡½æ•°ï¼› $H^*(u,v)=H(u,v)$ä¸ºå…¶å¤å…±è½­ï¼›

$S_f(u,v)=|F(u,v)|^2$ä¸ºæœªé€€åŒ–å‡½æ•°åŠŸç‡ï¼› $S_eta ( u, v) = | N( u, v) | ^2$ ä¸ºå™ªå£°åŠŸç‡è°±ï¼›

ä¿¡å™ªæ¯”é¢‘åŸŸ $"SNR" = (sum _(u = 0)^(M - 1) sum _(nu = 0)^(N - 1) |F(u, nu) |^2 ) / (sum _(u = 0)^(M - 1) sum _(nu = 0)^(N - 1) |N(u, nu) |^2)$ ç©ºåŸŸ$upright(S N R) = (sum_(x = 0)^(M - 1) sum_(y = 0)^(N - 1) hat(f)(x, y)^2  \/ sum_(x = 0)^(M - 1)) / (sum_(y = 0)^(N - 1)  [ f(x, y) - hat(f)(x, y)  ]^2)$

å‡æ–¹è¯¯å·® $upright(M S E) = frac(1, M N) sum_(x = 0)^(M - 1) sum_(y = 0)^(N - 1) [ f(x, y) - hat(f)(x, y) ]^2$


== çº¦æŸæœ€å°äºŒä¹˜æ–¹æ»¤æ³¢

çº¦æŸ$|g - H hat(f)|^2=|eta|^2$

å‡†åˆ™å‡½æ•°æœ€å°åŒ–$C = sum_(x = 0)^(M - 1) sum_(y = 0)^(N - 1) [ nabla^2 f(x, y) ]^2$

æœ€ä½³é—®é¢˜çš„è§£$hat(F)(u, v) =  [ frac(H^* (u comma v), |H(u comma v) |^2 + gamma |P(u comma v) |^2)  ] G(u, v)$ å½“$gamma$ = 0æ—¶,é€€å˜æˆé€†æ»¤æ³¢

P (u, v) ä¸º p(x, y) çš„å‚…é‡Œå¶å˜æ¢ p(x,y)ä¸ºæ‹‰æ™®æ‹‰æ–¯ç©ºé—´å·ç§¯æ ¸

== å‡ ä½•å‡å€¼æ»¤æ³¢

$hat(F)(u, v) = [ frac(H^* (u comma v), lr(|H(u comma v)|)^2) ]^a [ frac(H^* (u comma v), lr(|H(u comma v)|)^2 + beta [ frac(S_eta (u comma v), S_f (u comma v)) ]) ]^(1 - alpha)$

å½“ $alpha=0$ æ—¶,æ»¤æ³¢å™¨é€€åŒ–ä¸ºé€†æ»¤æ³¢å™¨ã€‚å½“ $alpha=0$ æ—¶,æ»¤æ³¢å™¨é€€åŒ–ä¸ºå‚æ•°ç»´çº³æ»¤æ³¢å™¨ã€‚å½“ $alpha=0,beta=1$ æ—¶,æ»¤æ³¢å™¨é€€åŒ–ä¸ºæ ‡å‡†ç»´çº³æ»¤æ³¢å™¨ã€‚å½“ $alpha=1/2$ æ—¶,æ»¤æ³¢å™¨ä¸ºå‡ ä½•å‡å€¼æ»¤æ³¢å™¨ã€‚å½“ $beta=1,alpha$ å‡åˆ° $1/2$ ä»¥ä¸Š,å®ƒæ¥è¿‘é€†æ»¤æ³¢å™¨,å½“ $beta=1,alpha$ å‡åˆ° $1/2$ ä»¥ä¸‹,å®ƒæ¥è¿‘ç»´çº³æ»¤æ³¢å™¨ã€‚å½“ $beta=1,alpha=1/2$ æ—¶,å®ƒè¢«ç§°ä¸ºè°±å‡è¡¡æ»¤æ³¢å™¨ã€‚